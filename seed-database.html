<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŒ± Database Seeder - Kids' Meal Planner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    
    <style>
        body { font-family: system-ui, -apple-system, sans-serif; }
        .log-entry { font-family: 'Courier New', monospace; font-size: 0.875rem; }
    </style>
</head>
<body class="bg-gradient-to-br from-green-500 to-blue-500 min-h-screen p-8">
    
    <div class="max-w-4xl mx-auto">
        
        <!-- Header -->
        <div class="bg-white rounded-2xl shadow-2xl p-8 mb-6">
            <div class="flex items-center gap-4 mb-4">
                <div class="text-6xl">ğŸŒ±</div>
                <div>
                    <h1 class="text-4xl font-bold text-green-600">Database Seeder</h1>
                    <p class="text-gray-600">Initialize Firebase with food items and composite builders</p>
                </div>
            </div>
            
            <div class="bg-blue-50 border-l-4 border-blue-400 p-4 rounded">
                <p class="text-blue-800">
                    <strong>âš ï¸ Important:</strong> Make sure you've configured Firebase credentials in 
                    <code class="bg-blue-100 px-2 py-1 rounded">js/firebase-config.js</code> before running this seeder.
                </p>
            </div>
        </div>
        
        <!-- Controls -->
        <div class="bg-white rounded-2xl shadow-2xl p-6 mb-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <button onclick="seedFoodItems()" class="bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition">
                    ğŸ Seed Food Items (57)
                </button>
                <button onclick="seedCompositeItems()" class="bg-purple-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-purple-700 transition">
                    ğŸ—ï¸ Seed Composite Items (3)
                </button>
                <button onclick="clearDatabase()" class="bg-red-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-red-700 transition">
                    ğŸ—‘ï¸ Clear All Collections
                </button>
                <button onclick="verifyDatabase()" class="bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition">
                    âœ… Verify Database
                </button>
            </div>
        </div>
        
        <!-- Console Log -->
        <div class="bg-white rounded-2xl shadow-2xl p-6">
            <h2 class="text-2xl font-bold text-gray-800 mb-4">Console Log</h2>
            <div id="console-log" class="bg-gray-900 text-green-400 p-4 rounded-lg h-96 overflow-y-auto font-mono text-sm">
                <div class="log-entry">ğŸŒ± Database seeder ready...</div>
                <div class="log-entry">âš ï¸  Configure Firebase credentials first!</div>
            </div>
        </div>
        
    </div>
    
    <script src="js/firebase-config.js"></script>
    
    <script>
        // Log function
        function log(message, type = 'info') {
            const consoleLog = document.getElementById('console-log');
            const timestamp = new Date().toLocaleTimeString();
            const icon = {
                'info': 'â„¹ï¸',
                'success': 'âœ…',
                'error': 'âŒ',
                'warning': 'âš ï¸'
            }[type] || 'â„¹ï¸';
            
            const entry = document.createElement('div');
            entry.className = 'log-entry';
            entry.textContent = `[${timestamp}] ${icon} ${message}`;
            consoleLog.appendChild(entry);
            consoleLog.scrollTop = consoleLog.scrollHeight;
        }
        
        // Food Items Data (57 items with Hebrew and English names)
        const foodItemsData = [
            // Proteins
            {id: 'food_001', name: 'Grilled Chicken', name_he: '×¢×•×£ ×¦×œ×•×™', category: 'protein', icon: 'ğŸ—', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_002', name: 'Fish Sticks', name_he: '×“×’×™ ××¦×‘×¢×•×ª', category: 'protein', icon: 'ğŸŸ', nutrition_score: 4, weekly_limit: 0, is_sweet: false},
            {id: 'food_003', name: 'Boiled Eggs', name_he: '×‘×™×¦×™× ×§×©×•×ª', category: 'protein', icon: 'ğŸ¥š', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_004', name: 'Turkey Slices', name_he: '×¤×¨×•×¡×•×ª ×”×•×“×•', category: 'protein', icon: 'ğŸ¦ƒ', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_005', name: 'Tuna Salad', name_he: '×¡×œ×˜ ×˜×•× ×”', category: 'protein', icon: 'ğŸ¥«', nutrition_score: 4, weekly_limit: 0, is_sweet: false},
            {id: 'food_006', name: 'Meatballs', name_he: '×§×¦×™×¦×•×ª', category: 'protein', icon: 'ğŸ–', nutrition_score: 4, weekly_limit: 0, is_sweet: false},
            {id: 'food_007', name: 'Cheese Cubes', name_he: '×§×•×‘×™×•×ª ×’×‘×™× ×”', category: 'protein', icon: 'ğŸ§€', nutrition_score: 4, weekly_limit: 0, is_sweet: false},
            {id: 'food_008', name: 'Peanut Butter', name_he: '×—×××ª ×‘×•×˜× ×™×', category: 'protein', icon: 'ğŸ¥œ', nutrition_score: 4, weekly_limit: 0, is_sweet: false},
            {id: 'food_009', name: 'Hummus', name_he: '×—×•××•×¡', category: 'protein', icon: 'ğŸ«˜', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_010', name: 'Tofu Nuggets', name_he: '× ×™×’×˜×¡ ×˜×•×¤×•', category: 'protein', icon: 'ğŸ¥¡', nutrition_score: 4, weekly_limit: 0, is_sweet: false},
            
            // Vegetables
            {id: 'food_011', name: 'Baby Carrots', name_he: '×’×–×¨ ×‘×™×™×‘×™', category: 'veggie', icon: 'ğŸ¥•', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_012', name: 'Cherry Tomatoes', name_he: '×¢×’×‘× ×™×•×ª ×©×¨×™', category: 'veggie', icon: 'ğŸ…', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_013', name: 'Cucumber Slices', name_he: '×¤×¨×•×¡×•×ª ××œ×¤×¤×•×Ÿ', category: 'veggie', icon: 'ğŸ¥’', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_014', name: 'Bell Pepper Strips', name_he: '×¨×¦×•×¢×•×ª ×¤×œ×¤×œ', category: 'veggie', icon: 'ğŸ«‘', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_015', name: 'Broccoli Florets', name_he: '×¤×¨×—×™ ×‘×¨×•×§×•×œ×™', category: 'veggie', icon: 'ğŸ¥¦', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_016', name: 'Celery Sticks', name_he: '××§×œ×•×ª ×¡×œ×¨×™', category: 'veggie', icon: 'ğŸŒ¿', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_017', name: 'Corn on the Cob', name_he: '×ª×™×¨×¡ ×‘×§×œ×—', category: 'veggie', icon: 'ğŸŒ½', nutrition_score: 4, weekly_limit: 0, is_sweet: false},
            {id: 'food_018', name: 'Peas', name_he: '××¤×•× ×”', category: 'veggie', icon: 'ğŸ«›', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_019', name: 'Sweet Potato', name_he: '×‘×˜×˜×”', category: 'veggie', icon: 'ğŸ ', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_020', name: 'Lettuce', name_he: '×—×¡×”', category: 'veggie', icon: 'ğŸ¥¬', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            
            // Fruits
            {id: 'food_021', name: 'Apple Slices', name_he: '×¤×¨×•×¡×•×ª ×ª×¤×•×—', category: 'fruit', icon: 'ğŸ', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_022', name: 'Banana', name_he: '×‘× × ×”', category: 'fruit', icon: 'ğŸŒ', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_023', name: 'Grapes', name_he: '×¢× ×‘×™×', category: 'fruit', icon: 'ğŸ‡', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_024', name: 'Orange Segments', name_he: '×¤×œ×—×™ ×ª×¤×•×–', category: 'fruit', icon: 'ğŸŠ', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_025', name: 'Strawberries', name_he: '×ª×•×ª×™×', category: 'fruit', icon: 'ğŸ“', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_026', name: 'Blueberries', name_he: '××•×›×× ×™×•×ª', category: 'fruit', icon: 'ğŸ«', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_027', name: 'Watermelon Cubes', name_he: '×§×•×‘×™×•×ª ××‘×˜×™×—', category: 'fruit', icon: 'ğŸ‰', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_028', name: 'Pineapple Chunks', name_he: '×—×ª×™×›×•×ª ×× × ×¡', category: 'fruit', icon: 'ğŸ', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_029', name: 'Peach', name_he: '××¤×¨×¡×§', category: 'fruit', icon: 'ğŸ‘', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_030', name: 'Pear', name_he: '××’×¡', category: 'fruit', icon: 'ğŸ', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            
            // Grains
            {id: 'food_031', name: 'Whole Wheat Bread', name_he: '×œ×—× ××œ×', category: 'grain', icon: 'ğŸ', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_032', name: 'Pita Bread', name_he: '×¤×™×ª×”', category: 'grain', icon: 'ğŸ«“', nutrition_score: 4, weekly_limit: 0, is_sweet: false},
            {id: 'food_033', name: 'Brown Rice', name_he: '××•×¨×– ××œ×', category: 'grain', icon: 'ğŸš', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_034', name: 'Pasta', name_he: '×¤×¡×˜×”', category: 'grain', icon: 'ğŸ', nutrition_score: 4, weekly_limit: 0, is_sweet: false},
            {id: 'food_035', name: 'Crackers', name_he: '×§×¨×§×¨×™×', category: 'grain', icon: 'ğŸ˜', nutrition_score: 3, weekly_limit: 0, is_sweet: false},
            {id: 'food_036', name: 'Oatmeal', name_he: '×©×™×‘×•×œ×ª ×©×•×¢×œ', category: 'grain', icon: 'ğŸ¥£', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_037', name: 'Cereal', name_he: '×“×’× ×™ ×‘×•×§×¨', category: 'grain', icon: 'ğŸ¥›', nutrition_score: 3, weekly_limit: 0, is_sweet: false},
            {id: 'food_038', name: 'Bagel', name_he: '×‘×™×™×’×œ', category: 'grain', icon: 'ğŸ¥¯', nutrition_score: 3, weekly_limit: 0, is_sweet: false},
            {id: 'food_039', name: 'Tortilla', name_he: '×˜×•×¨×˜×™×™×”', category: 'grain', icon: 'ğŸŒ®', nutrition_score: 4, weekly_limit: 0, is_sweet: false},
            {id: 'food_040', name: 'Couscous', name_he: '×§×•×¡×§×•×¡', category: 'grain', icon: 'ğŸš', nutrition_score: 4, weekly_limit: 0, is_sweet: false},
            
            // Dairy
            {id: 'food_041', name: 'Milk', name_he: '×—×œ×‘', category: 'dairy', icon: 'ğŸ¥›', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_042', name: 'Yogurt', name_he: '×™×•×’×•×¨×˜', category: 'dairy', icon: 'ğŸ¥„', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_043', name: 'String Cheese', name_he: '×’×‘×™× ×ª ×—×•×˜×™×', category: 'dairy', icon: 'ğŸ§€', nutrition_score: 4, weekly_limit: 0, is_sweet: false},
            {id: 'food_044', name: 'Cottage Cheese', name_he: '×’×‘×™× ×ª ×§×•×˜×’', category: 'dairy', icon: 'ğŸ¥›', nutrition_score: 5, weekly_limit: 0, is_sweet: false},
            {id: 'food_045', name: 'Chocolate Milk', name_he: '×—×œ×‘ ×©×•×§×•×œ×“', category: 'dairy', icon: 'ğŸ«', nutrition_score: 3, weekly_limit: 0, is_sweet: true},
            {id: 'food_046', name: 'Smoothie', name_he: '×©×™×™×§', category: 'dairy', icon: 'ğŸ¥¤', nutrition_score: 4, weekly_limit: 0, is_sweet: false},
            {id: 'food_047', name: 'Ice Cream', name_he: '×’×œ×™×“×”', category: 'dairy', icon: 'ğŸ¦', nutrition_score: 2, weekly_limit: 2, is_sweet: true},
            
            // Snacks
            {id: 'food_048', name: 'Popcorn', name_he: '×¤×•×¤×§×•×¨×Ÿ', category: 'snack', icon: 'ğŸ¿', nutrition_score: 3, weekly_limit: 0, is_sweet: false},
            {id: 'food_049', name: 'Pretzels', name_he: '×‘×™×™×’×œ×” ××œ×•×—', category: 'snack', icon: 'ğŸ¥¨', nutrition_score: 3, weekly_limit: 0, is_sweet: false},
            {id: 'food_050', name: 'Trail Mix', name_he: '×ª×¢×¨×•×‘×ª ×©×‘×™×œ', category: 'snack', icon: 'ğŸ¥œ', nutrition_score: 4, weekly_limit: 0, is_sweet: false},
            {id: 'food_051', name: 'Granola Bar', name_he: '×—×˜×™×£ ×’×¨× ×•×œ×”', category: 'snack', icon: 'ğŸ«', nutrition_score: 3, weekly_limit: 0, is_sweet: false},
            {id: 'food_052', name: 'Rice Cakes', name_he: '×œ×‘×™×‘×•×ª ××•×¨×–', category: 'snack', icon: 'ğŸ˜', nutrition_score: 3, weekly_limit: 0, is_sweet: false},
            {id: 'food_053', name: 'Fruit Snacks', name_he: '×—×˜×™×¤×™ ×¤×™×¨×•×ª', category: 'snack', icon: 'ğŸ¬', nutrition_score: 2, weekly_limit: 2, is_sweet: true},
            {id: 'food_054', name: 'Cookies', name_he: '×¢×•×’×™×•×ª', category: 'snack', icon: 'ğŸª', nutrition_score: 2, weekly_limit: 2, is_sweet: true},
            {id: 'food_055', name: 'Chocolate', name_he: '×©×•×§×•×œ×“', category: 'snack', icon: 'ğŸ«', nutrition_score: 2, weekly_limit: 1, is_sweet: true},
            {id: 'food_056', name: 'Chips', name_he: '×¦\'×™×¤×¡', category: 'snack', icon: 'ğŸ¥”', nutrition_score: 2, weekly_limit: 2, is_sweet: false},
            {id: 'food_057', name: 'Gummy Bears', name_he: '×“×•×‘×•× ×™× ×’×•××™', category: 'snack', icon: 'ğŸ»', nutrition_score: 1, weekly_limit: 1, is_sweet: true}
        ];
        
        // Composite Items Data
        const compositeItemsData = [
            {
                id: 'composite_001',
                name: 'Sandwich Builder',
                name_he: '×‘× ×™×™×ª ×›×¨×™×š',
                category: 'grain',
                icon: 'ğŸ—ï¸ğŸ¥ª',
                steps: JSON.stringify(['Bread', 'Filling', 'Veggies']),
                ingredients_map: JSON.stringify({
                    'Bread': ['ğŸ White', 'ğŸŒ¾ Wheat', 'ğŸ¥– Baguette', 'ğŸ¥¯ Bagel', 'ğŸ«“ Pita'],
                    'Filling': ['ğŸ§€ Cheese', 'ğŸ¦ƒ Turkey', 'ğŸ— Chicken', 'ğŸ¥š Egg', 'ğŸ¥œ PB&J', 'ğŸ¥« Tuna'],
                    'Veggies': ['ğŸ¥¬ Lettuce', 'ğŸ… Tomato', 'ğŸ¥’ Cucumber', 'ğŸ§… Onion', 'ğŸ«‘ Pepper']
                })
            },
            {
                id: 'composite_002',
                name: 'Pasta Builder',
                name_he: '×‘× ×™×™×ª ×¤×¡×˜×”',
                category: 'grain',
                icon: 'ğŸ—ï¸ğŸ',
                steps: JSON.stringify(['Pasta', 'Sauce', 'Toppings']),
                ingredients_map: JSON.stringify({
                    'Pasta': ['ğŸ Spaghetti', 'ğŸ¦ Penne', 'ğŸ€ Farfalle', 'ğŸœ Macaroni', 'ğŸ¥˜ Ravioli'],
                    'Sauce': ['ğŸ… Marinara', 'ğŸ§ˆ Alfredo', 'ğŸ§„ Pesto', 'ğŸ¥« Bolognese', 'ğŸ§€ Cheese'],
                    'Toppings': ['ğŸ§€ Parmesan', 'ğŸ– Meatballs', 'ğŸ¥¦ Broccoli', 'ğŸ„ Mushrooms', 'ğŸ«’ Olives']
                })
            },
            {
                id: 'composite_003',
                name: 'Salad Builder',
                name_he: '×‘× ×™×™×ª ×¡×œ×˜',
                category: 'veggie',
                icon: 'ğŸ—ï¸ğŸ¥—',
                steps: JSON.stringify(['Base', 'Protein', 'Dressing']),
                ingredients_map: JSON.stringify({
                    'Base': ['ğŸ¥¬ Lettuce', 'ğŸ¥— Spinach', 'ğŸ¥’ Cucumber', 'ğŸ… Tomatoes', 'ğŸ¥• Carrots'],
                    'Protein': ['ğŸ— Chicken', 'ğŸ¥š Egg', 'ğŸ§€ Cheese', 'ğŸ¥« Tuna', 'ğŸ«˜ Chickpeas'],
                    'Dressing': ['ğŸ«’ Olive Oil', 'ğŸ‹ Lemon', 'ğŸ¥— Ranch', 'ğŸ§ˆ Caesar', 'ğŸ¯ Honey Mustard']
                })
            }
        ];
        
        // Seed Food Items
        async function seedFoodItems() {
            log('ğŸŒ± Starting to seed food items...', 'info');
            
            try {
                const batch = db.batch();
                let count = 0;
                
                for (const item of foodItemsData) {
                    const docRef = db.collection('food_items').doc(item.id);
                    batch.set(docRef, {
                        ...item,
                        created_at: firebase.firestore.FieldValue.serverTimestamp(),
                        updated_at: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    count++;
                }
                
                await batch.commit();
                log(`âœ… Successfully seeded ${count} food items!`, 'success');
                
            } catch (error) {
                log(`âŒ Error seeding food items: ${error.message}`, 'error');
                console.error(error);
            }
        }
        
        // Seed Composite Items
        async function seedCompositeItems() {
            log('ğŸ—ï¸ Starting to seed composite items...', 'info');
            
            try {
                const batch = db.batch();
                let count = 0;
                
                for (const item of compositeItemsData) {
                    const docRef = db.collection('composite_items').doc(item.id);
                    batch.set(docRef, {
                        ...item,
                        created_at: firebase.firestore.FieldValue.serverTimestamp(),
                        updated_at: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    count++;
                }
                
                await batch.commit();
                log(`âœ… Successfully seeded ${count} composite items!`, 'success');
                
            } catch (error) {
                log(`âŒ Error seeding composite items: ${error.message}`, 'error');
                console.error(error);
            }
        }
        
        // Clear Database
        async function clearDatabase() {
            if (!confirm('âš ï¸ Are you sure you want to clear ALL data from the database? This cannot be undone!')) {
                return;
            }
            
            log('ğŸ—‘ï¸ Starting to clear database...', 'warning');
            
            const collections = ['food_items', 'composite_items', 'users', 'meal_plans', 'shopping_lists', 'custom_foods', 'rules'];
            
            try {
                for (const collectionName of collections) {
                    const snapshot = await db.collection(collectionName).get();
                    const batch = db.batch();
                    let count = 0;
                    
                    snapshot.forEach(doc => {
                        batch.delete(doc.ref);
                        count++;
                    });
                    
                    if (count > 0) {
                        await batch.commit();
                        log(`ğŸ—‘ï¸ Deleted ${count} documents from ${collectionName}`, 'warning');
                    } else {
                        log(`â„¹ï¸  Collection ${collectionName} was already empty`, 'info');
                    }
                }
                
                log('âœ… Database cleared successfully!', 'success');
                
            } catch (error) {
                log(`âŒ Error clearing database: ${error.message}`, 'error');
                console.error(error);
            }
        }
        
        // Verify Database
        async function verifyDatabase() {
            log('ğŸ” Verifying database...', 'info');
            
            const collections = {
                'food_items': 57,
                'composite_items': 3,
                'users': 0,
                'meal_plans': 0,
                'shopping_lists': 0,
                'custom_foods': 0,
                'rules': 0
            };
            
            try {
                for (const [collectionName, expectedCount] of Object.entries(collections)) {
                    const snapshot = await db.collection(collectionName).get();
                    const actualCount = snapshot.size;
                    
                    if (expectedCount > 0 && actualCount === expectedCount) {
                        log(`âœ… ${collectionName}: ${actualCount}/${expectedCount} documents`, 'success');
                    } else if (expectedCount === 0) {
                        log(`â„¹ï¸  ${collectionName}: ${actualCount} documents (user data)`, 'info');
                    } else {
                        log(`âš ï¸  ${collectionName}: ${actualCount}/${expectedCount} documents (expected ${expectedCount})`, 'warning');
                    }
                }
                
                log('âœ… Database verification complete!', 'success');
                
            } catch (error) {
                log(`âŒ Error verifying database: ${error.message}`, 'error');
                console.error(error);
            }
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            log('âœ… Seeder initialized and ready', 'success');
            log('', 'info');
            log('ğŸ“ Instructions:', 'info');
            log('1. Make sure Firebase is configured in js/firebase-config.js', 'info');
            log('2. Click "Seed Food Items" to add 57 food items', 'info');
            log('3. Click "Seed Composite Items" to add 3 builders', 'info');
            log('4. Click "Verify Database" to check everything worked', 'info');
        });
    </script>
    
</body>
</html>
